<!DOCTYPE html>
<html class="bg-black">
<head>
    <meta charset="UTF-8">
    <title>AdminLTE | Log in</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <!-- bootstrap 3.0.2 -->
    <link href="resources/css/bootstrap.css" rel="stylesheet" type="text/css" />
    <!-- font Awesome -->
    <link href="resources/css/font-awesome.css" rel="stylesheet" type="text/css" />
    <!-- Theme style -->
    <link href="resources/css/AdminLTE.css" rel="stylesheet" type="text/css" />

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
</head>
<body class="bg-black">

<div class="form-box" id="login_box">
    <div class="header">Sign in to continue to MRest</div>
        <div class="body bg-white">
            <div class="textbox-wrap">
                <div class="form-group">
                    <input type="text" id="UID" name="userid" class="form-control" placeholder="User Name" onkeyup="validTextField(this)" />
                </div>
            </div>
            <div class="textbox-wrap">
                <div class="form-group">
                    <input type="password" id="PID" name="password" class="form-control" placeholder="Password" onkeyup="validTextField(this)"/>
                </div>
            </div>
            <div class="form-group">
                <input type="checkbox" name="remember_me"/> Remember me
            </div>
        </div>
        <div class="footer">
            <div id="divAlerts" data-alerts="alerts" data-ids="myid" data-fade="6000"></div>

            <button id="button_login" type="submit" class="btn bg-olive btn-block">Sign me in</button>

            <p><a href="#">I forgot my password</a></p>

            <a href="register.html" class="text-center">Register a new membership</a>
        </div>
</div>

<!-- jQuery 2.0.2 -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
<!-- Bootstrap -->
<script src="resources/js/bootstrap.js" type="text/javascript"></script>
<!-- jQuery Bootstrap Alerts -->
<script src="resources/js/jquery.bsAlerts.js"></script>

<script type="text/javascript">

    $(document).ready(function(){

        $('#error_message').hide();

        $(function () {
            $(".form-control").focus(function () {
                $(this).closest(".textbox-wrap").addClass("focused");
            }).blur(function () {
                $(this).closest(".textbox-wrap").removeClass("focused");
            });
        });

        $('#button_login').click(function() {
            var user = $('#UID').val();
            var pass = $('#PID').val();

            if(user == '' || pass == '') {
                validTextField($('#UID'));
                validTextField($('#PID'));
                return false;
            }

            $('#button_login').addClass('loader');

            $.ajax({
                type : 'GET',
                complete: function(){
                    $('#button_login').removeClass('loader');
                },
                dataType : 'json',
                contentType : "application/json",
                url : "http://localhost:8080/RestApp/api/login/path/username/" + user + "/password/" + pass,
                success : function(data) {
                    if(data.responseCode == 'FAILED') {
                        $('#divAlerts').find('div').remove();
                        $(document).trigger("add-alerts", [
                            {
                                'message': data.responseMessage,
                                'priority': 'error'
                            }
                        ]);
                        return false;
                    } else {
                        window.location = "welcome.html";
                    }
                },
                error : function(xhr, err) {
                    console.log('Sample of error data:', err);
                    console.log("readyState: " + xhr.readyState + "\nstatus: "
                            + xhr.status + "\nresponseText: "
                            + xhr.responseText);
                    $('#divAlerts').find('div').remove();
                    $(document).trigger("add-alerts", [
                        {
                            'message': xhr.responseText,
                            'priority': 'error'
                        }
                    ]);
                }
            });
        });
    });

    function validTextField(elem) {
        var user = $(elem).val();
        if(user == '') {
            $(elem).addClass('valid_failed');
            $(elem).removeClass('valid_approved');

        } else if(user != '') {
            $(elem).removeClass('valid_failed');
            $(elem).addClass('valid_approved');
        }
    }

</script>
</body>
</html>